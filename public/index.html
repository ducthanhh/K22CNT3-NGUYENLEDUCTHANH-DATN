<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ocean Luxury Cruises | Tr·∫£i Nghi·ªám Th∆∞·ª£ng L∆∞u</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* --- 1. C√ÄI ƒê·∫∂T CHUNG --- */
        :root {
            --primary: #0a2540; /* Xanh bi·ªÉn s√¢u */
            --gold: #d4af37;    /* V√†ng kim lo·∫°i */
            --white: #ffffff;
            --text-light: #f4f4f4;
            --text-dark: #333;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Poppins', sans-serif;
            color: var(--text-dark);
            line-height: 1.6;
            background-color: #f9f9f9;
        }

        h1, h2, h3 { font-family: 'Playfair Display', serif; }

        a { text-decoration: none; color: inherit; transition: 0.3s; }
        ul { list-style: none; }

        /* --- 2. HEADER & NAV --- */
        header {
            background-color: var(--primary);
            color: var(--white);
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        nav {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo { font-size: 1.8rem; font-weight: bold; color: var(--gold); }
        
        .nav-links { display: flex; gap: 30px; }
        .nav-links a:hover { color: var(--gold); }
        .btn-cta {
            padding: 10px 25px;
            background: var(--gold);
            color: var(--primary);
            border-radius: 30px;
            font-weight: bold;
        }
        .btn-cta:hover { background: #b59226; }

        /* --- 3. HERO SECTION (PH·∫¶N M·ªû ƒê·∫¶U) --- */
        .hero {
            height: 90vh;
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.5)), 
                        url('https://images.unsplash.com/photo-1548574505-5e239809ee19?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: var(--white);
        }

        .hero-content h1 { font-size: 4rem; margin-bottom: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        .hero-content p { font-size: 1.5rem; margin-bottom: 40px; }
        .btn-hero {
            padding: 15px 40px;
            font-size: 1.2rem;
            background: var(--gold);
            color: var(--primary);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
            transition: transform 0.2s;
        }
        .btn-hero:hover { transform: translateY(-3px); }

        /* --- 4. C√ÅC CHUY·∫æN ƒêI (TOURS) --- */
        .section-title { text-align: center; margin: 80px 0 50px; color: var(--primary); font-size: 2.5rem; }
        
        .tours-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .tour-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .tour-card:hover { transform: translateY(-10px); }

        .tour-img {
            height: 250px;
            width: 100%;
            object-fit: cover;
        }

        .tour-info { padding: 25px; }
        .tour-info h3 { color: var(--primary); margin-bottom: 10px; }
        .price { color: var(--gold); font-weight: bold; font-size: 1.2rem; margin-top: 15px; display: block; }

        /* --- 5. FORM ƒê·∫∂T V√â (BOOKING) --- */
        .booking-section {
            background-color: var(--primary);
            padding: 80px 20px;
            margin-top: 80px;
            display: flex;
            justify-content: center;
        }

        .booking-form {
            background: rgba(255, 255, 255, 0.1); /* Hi·ªáu ·ª©ng k√≠nh */
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            width: 100%;
            max-width: 800px;
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
        }

        .booking-form h2 { text-align: center; margin-bottom: 30px; color: var(--gold); }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .form-group label { display: block; margin-bottom: 8px; font-weight: 300; }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: rgba(255,255,255,0.9);
            font-family: 'Poppins', sans-serif;
        }

        .full-width { grid-column: span 2; }

        .btn-submit {
            width: 100%;
            padding: 15px;
            background: var(--gold);
            color: var(--primary);
            border: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            transition: 0.3s;
        }
        .btn-submit:hover { background: #fff; }

        /* --- 6. FOOTER --- */
        footer {
            background: #051a2e;
            color: rgba(255,255,255,0.7);
            text-align: center;
            padding: 40px 0;
            margin-top: 0;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .hero-content h1 { font-size: 2.5rem; }
            .form-grid { grid-template-columns: 1fr; }
            .full-width { grid-column: span 1; }
            .nav-links { display: none; } /* ·∫®n menu tr√™n mobile cho g·ªçn */
        }




        /* ===== FOOTER M·ªû R·ªòNG ===== */
.main-footer {
    background: #051a2e;
    color: rgba(255,255,255,0.8);
    padding-top: 60px;
    font-size: 0.95rem;
}

.footer-container {
    max-width: 1200px;
    margin: auto;
    padding: 0 20px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 40px;
}

.footer-col h3,
.footer-col h4 {
    color: var(--gold);
    margin-bottom: 20px;
    font-family: 'Playfair Display', serif;
}

.footer-col p {
    line-height: 1.8;
}

.footer-col ul li {
    margin-bottom: 10px;
}

.footer-col ul li a {
    color: rgba(255,255,255,0.8);
}

.footer-col ul li a:hover {
    color: var(--gold);
    padding-left: 5px;
}

.social-links a {
    display: inline-block;
    margin-right: 15px;
    color: var(--gold);
    font-weight: bold;
}

.social-links a:hover {
    text-decoration: underline;
}

.footer-bottom {
    text-align: center;
    padding: 30px 10px;
    margin-top: 40px;
    border-top: 1px solid rgba(255,255,255,0.1);
    font-size: 0.85rem;
    color: rgba(255,255,255,0.6);
}

/* Responsive footer */
@media (max-width: 768px) {
    .footer-container {
        text-align: center;
    }
    .social-links a {
        display: block;
        margin: 8px 0;
    }
}

    </style>
</head>
<body>

    <header>
        <nav>
            <div class="logo">ƒë·ª©c th√†nh tour</div>
            <ul class="nav-links">
                <li><a href="#home">Trang Ch·ªß</a></li>
                <li><a href="#tours">H·∫£i Tr√¨nh</a></li>
                <li><a href="#about">V·ªÅ Ch√∫ng T√¥i</a></li>
                <li><a href="/login" style="color: var(--gold);">ƒêƒÉng Nh·∫≠p</a></li>
            </ul>
            <a href="#booking" class="btn-cta">ƒê·∫∑t Ngay</a>
        </nav>
    </header>

    <section id="home" class="hero">
        <div class="hero-content">
            <h1>ƒê√°nh Th·ª©c Gi·∫•c M∆° kh√°m ph√° s√¥ng ƒë√†</h1>
            <p>H√†nh tr√¨nh 5 sao ƒë·∫≥ng c·∫•p th·∫ø gi·ªõi ƒëang ch·ªù ƒë√≥n b·∫°n</p>
            <button class="btn-hero" onclick="document.getElementById('booking').scrollIntoView({behavior: 'smooth'})">ƒê·∫∑t L·ªãch Ngay</button>
        </div>
    </section>

   <h2 id="tours" class="section-title">C√°c ƒêi·ªÉm ƒê·∫øn N·ªïi B·∫≠t T·∫°i H√≤a B√¨nh</h2>
<div class="tours-container">

    <a href="den-thac-bo.html" class="tour-link">
        <div class="tour-card">
            <img src="https://images.unsplash.com/photo-1596436889106-be35e843f974?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80" alt="ƒê·ªÅn Th√°c B·ªù" class="tour-img">
            <div class="tour-info">
                <h3>ƒê·ªÅn Th√°c B·ªù</h3>
                <p>Du l·ªãch t√¢m linh - Chi√™m b√°i ƒë·ªÅn Ch√∫a Th√°c B·ªù linh thi√™ng gi·ªØa l√≤ng h·ªì.</p>
                <span class="price">T·ª´ 500.000 VNƒê/kh√°ch</span>
            </div>
        </div>
    </a>
    
    <a href="song-da.html" class="tour-link">
        <div class="tour-card">
            <img src="https://images.unsplash.com/photo-1504214208698-ea1916a2195a?auto=format&fit=crop&w=1000&q=80" alt="S√¥ng ƒê√†" class="tour-img">
            <div class="tour-info">
                <h3>Du Ngo·∫°n S√¥ng ƒê√†</h3>
                <p>"H·∫° Long tr√™n c·∫°n" - Th∆∞·ªüng ngo·∫°n v·∫ª ƒë·∫πp h√πng vƒ© c·ªßa n√∫i non s√¥ng n∆∞·ªõc.</p>
                <span class="price">T·ª´ 800.000 VNƒê/kh√°ch</span>
            </div>
        </div>
    </a>

    <a href="thung-nai.html" class="tour-link">
        <div class="tour-card">
            <img src="https://images.unsplash.com/photo-1476514525535-07fb3b4ae5f1?auto=format&fit=crop&w=1000&q=80" alt="Thung Nai" class="tour-img">
            <div class="tour-info">
                <h3>B·∫øn C·∫£ng Thung Nai</h3>
                <p>C·ª≠a ng√µ kh√°m ph√° - Tr·∫£i nghi·ªám cu·ªôc s·ªëng b·∫£n ƒë·ªãa v√† ·∫©m th·ª±c ƒë·∫∑c s·∫Øc.</p>
                <span class="price">T·ª´ 1.200.000 VNƒê/kh√°ch</span>
            </div>
        </div>
    </a>
</div>


    <section id="booking" class="booking-section">
        <form action="/dat-ve" method="POST" class="booking-form">
            <h2>ƒê·∫∑t V√© Tr·ª±c Tuy·∫øn</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label>H·ªç v√† t√™n qu√Ω kh√°ch</label>
                    <input type="text" name="ho_ten" required placeholder="Nh·∫≠p h·ªç t√™n...">
                </div>
                
                <div class="form-group">
                    <label>Email li√™n h·ªá</label>
                    <input type="email" name="email" required placeholder="email@vidu.com">
                </div>

                <div class="form-group">
                    <label>S·ªë ƒëi·ªán tho·∫°i</label>
                    <input type="tel" name="sdt" required placeholder="0912...">
                </div>

                <div class="form-group">
    <label>Ch·ªçn H√†nh Tr√¨nh</label>
    <select name="schedule_id" id="select-lich-trinh" required>
        <option value="">-- ƒêang t·∫£i l·ªãch tr√¨nh... --</option>
    </select>
</div>

                <div class="form-group">
                    <label>Ng√†y kh·ªüi h√†nh</label>
                    <input type="date" name="ngay_di" required>
                </div>

                <div class="form-group">
    <label>S·ªë l∆∞·ª£ng kh√°ch <span id="seat-info" style="color: yellow; font-size: 0.9em;">(ƒêang ki·ªÉm tra ch·ªó...)</span></label>
    <input type="number" id="inp-so-khach" name="so_khach" value="1" min="1" required>
</div>

<div class="form-group full-width" style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; text-align: right;">
    <label style="display:inline;">T·∫°m t√≠nh:</label>
    <span id="display-total" style="font-size: 1.5rem; color: #d4af37; font-weight: bold;">0 ‚Ç´</span>
</div>

                <div class="form-group full-width">
                    <label>Ghi ch√∫ ƒë·∫∑c bi·ªát (ƒÇn chay, ph√≤ng VIP...)</label>
                    <textarea name="ghi_chu" rows="3"></textarea>
                </div>

                <div class="form-group full-width">
                    <button type="submit" class="btn-submit">X√ÅC NH·∫¨N ƒê·∫∂T CH·ªñ</button>
                </div>
            </div>
        </form>
    </section>

    <footer class="main-footer">
    <div class="footer-container">

        <!-- C·ªòT 1: GI·ªöI THI·ªÜU -->
        <div class="footer-col">
            <h3>ƒê·ª®C TH√ÄNH TOUR</h3>
            <p>
                ƒê·ª©c Th√†nh Tour chuy√™n cung c·∫•p d·ªãch v·ª• du l·ªãch t√†u tham quan
                s√¥ng ƒê√† ‚Äì Thung Nai ‚Äì ƒê·ªÅn Th√°c B·ªù v·ªõi tr·∫£i nghi·ªám an to√†n,
                chuy√™n nghi·ªáp v√† ƒë·∫≥ng c·∫•p.
            </p>
        </div>

        <!-- C·ªòT 2: LI√äN K·∫æT NHANH -->
        <div class="footer-col">
            <h4>Li√™n K·∫øt Nhanh</h4>
            <ul>
                <li><a href="#home">Trang ch·ªß</a></li>
                <li><a href="#tours">L·ªãch tr√¨nh</a></li>
                <li><a href="#booking">ƒê·∫∑t v√©</a></li>
                <li><a href="#about">V·ªÅ ch√∫ng t√¥i</a></li>
                <li><a href="/login">ƒêƒÉng nh·∫≠p</a></li>
            </ul>
        </div>

        <!-- C·ªòT 3: TH√îNG TIN LI√äN H·ªÜ -->
        <div class="footer-col">
            <h4>Th√¥ng Tin Li√™n H·ªá</h4>
            <p>üìç Thung Nai, Cao Phong, H√≤a B√¨nh</p>
            <p>üìû Hotline: 1900 1234</p>
            <p>‚úâÔ∏è Email: ducthanhtour@gmail.com</p>
            <p>‚è∞ Gi·ªù l√†m vi·ªác: 07:00 ‚Äì 21:00</p>
        </div>

        <!-- C·ªòT 4: M·∫†NG X√É H·ªòI -->
        <div class="footer-col">
            <h4>K·∫øt N·ªëi V·ªõi Ch√∫ng T√¥i</h4>
            <div class="social-links">
                <a href="#">Facebook</a>
                <a href="#">Zalo</a>
                <a href="#">Instagram</a>
                <a href="#">YouTube</a>
            </div>
        </div>

    </div>

    <!-- B·∫¢N QUY·ªÄN -->
    <div class="footer-bottom">
        <p>
            ¬© 2025 ƒê·ª©c Th√†nh Tour | Website ƒë·∫∑t l·ªãch t√†u du l·ªãch s√¥ng ƒê√†  
            <br>
        </p>
    </div>
</footer>

<script>
    // 1. X·ª¨ L√ù HI·ªÇN TH·ªä MENU NG∆Ø·ªúI D√ôNG (Gi·ªØ nguy√™n logic c≈©)
    fetch('/api/current-user')
        .then(res => res.json())
        .then(user => {
            const navLinks = document.querySelector('.nav-links');
            if (user) {
                let menuHtml = `<li><a href="/">Trang Ch·ªß</a></li><li><a href="#tours">H·∫£i Tr√¨nh</a></li>`;
                if (user.role === 'admin') {
                    menuHtml += `<li><a href="/admin" style="color: red; font-weight:bold;">QU·∫¢N TR·ªä VI√äN</a></li>`;
                } else {
                    menuHtml += `<li><a href="/my-tickets">V√© C·ªßa T√¥i</a></li>`;
                }
                menuHtml += `<li><span style="color: var(--gold);">Ch√†o, ${user.full_name}</span></li><li><a href="/logout">Tho√°t</a></li>`;
                navLinks.innerHTML = menuHtml;

                // ƒêi·ªÅn th√¥ng tin v√†o form
                const nameInput = document.querySelector('input[name="ho_ten"]');
                const emailInput = document.querySelector('input[name="email"]');
                const phoneInput = document.querySelector('input[name="sdt"]');
                if(nameInput) nameInput.value = user.full_name;
                if(emailInput) emailInput.value = user.email;
                if(phoneInput) phoneInput.value = user.phone;
            }
        });
</script>

<script>
    // 2. X·ª¨ L√ù CH·ªåN CHUY·∫æN ƒêI V√Ä T√çNH GI√Å (LOGIC M·ªöI)
    
    // Khai b√°o c√°c bi·∫øn to√†n c·ª•c
    let currentPrice = 0;
    let maxSeats = 0;

    // L·∫•y c√°c th·∫ª HTML c·∫ßn d√πng
    const selectLichTrinh = document.getElementById('select-lich-trinh');
    const inpSoKhach = document.getElementById('inp-so-khach');
    const txtSeatInfo = document.getElementById('seat-info');
    const txtTotal = document.getElementById('display-total');
    const btnSubmit = document.querySelector('.btn-submit');

    // B∆Ø·ªöC 1: T·∫£i danh s√°ch chuy·∫øn ƒëi v√†o √¥ Select khi trang v·ª´a m·ªü
    fetch('/api/schedules-list')
        .then(res => res.json())
        .then(data => {
            selectLichTrinh.innerHTML = '<option value="">-- Vui l√≤ng ch·ªçn chuy·∫øn ƒëi --</option>';
            
            if (data.length === 0) {
                selectLichTrinh.innerHTML = '<option value="">Hi·ªán ch∆∞a c√≥ chuy·∫øn n√†o</option>';
                return;
            }

            data.forEach(trip => {
                const option = document.createElement('option');
                option.value = trip.schedule_id; // Gi√° tr·ªã g·ª≠i ƒëi l√† ID
                
                // Hi·ªÉn th·ªã t√™n ƒë·∫πp: "H√≤a B√¨nh -> Th√°c B·ªù (08:00 - T√†u 01)"
                const time = new Date(trip.departure_time).toLocaleTimeString('vi-VN', {hour: '2-digit', minute:'2-digit'});
                option.text = `${trip.diem_di} ‚ûù ${trip.diem_den} (${time} - ${trip.ship_name})`;
                selectLichTrinh.appendChild(option);
            });
        });

    // B∆Ø·ªöC 2: Khi ng∆∞·ªùi d√πng CH·ªåN 1 chuy·∫øn ƒëi -> H·ªèi Server gi√° ti·ªÅn
    selectLichTrinh.addEventListener('change', function() {
        const scheduleId = this.value;

        // N·∫øu ng∆∞·ªùi d√πng ch·ªçn m·ª•c m·∫∑c ƒë·ªãnh (R·ªóng)
        if (!scheduleId) {
            resetForm();
            return;
        }

        txtSeatInfo.innerText = "(ƒêang l·∫•y gi√° v√©...)";

        // G·ª≠i ID l√™n server ƒë·ªÉ l·∫•y gi√°: /api/schedule-info?id=...
        fetch(`/api/schedule-info?id=${scheduleId}`)
            .then(res => res.json())
            .then(data => {
                if (data.error) {
                    alert("Kh√¥ng l·∫•y ƒë∆∞·ª£c th√¥ng tin chuy·∫øn n√†y!");
                    return;
                }

                // C·∫≠p nh·∫≠t d·ªØ li·ªáu v√†o bi·∫øn
                currentPrice = data.price;
                maxSeats = data.remaining;

                // C·∫≠p nh·∫≠t giao di·ªán
                if (maxSeats <= 0) {
                    txtSeatInfo.innerText = "(ƒê√É H·∫æT CH·ªñ)";
                    txtSeatInfo.style.color = "red";
                    btnSubmit.disabled = true;
                    btnSubmit.innerText = "H·∫æT V√â";
                    btnSubmit.style.background = "gray";
                    inpSoKhach.disabled = true;
                } else {
                    txtSeatInfo.innerText = `(C√≤n l·∫°i: ${maxSeats} ch·ªó - Gi√°: ${currentPrice.toLocaleString()}ƒë/v√©)`;
                    txtSeatInfo.style.color = "#d4af37"; // M√†u v√†ng
                    btnSubmit.disabled = false;
                    btnSubmit.innerText = "X√ÅC NH·∫¨N ƒê·∫∂T CH·ªñ";
                    btnSubmit.style.background = "var(--gold)";
                    inpSoKhach.disabled = false;
                    inpSoKhach.max = maxSeats; // Gi·ªõi h·∫°n s·ªë nh·∫≠p v√†o
                    
                    // T√≠nh l·∫°i t·ªïng ti·ªÅn ngay l·∫≠p t·ª©c
                    calculateTotal();
                }
            });
    });

    // B∆Ø·ªöC 3: Khi ng∆∞·ªùi d√πng thay ƒë·ªïi S·ªê L∆Ø·ª¢NG KH√ÅCH -> T√≠nh l·∫°i t·ªïng ti·ªÅn
    inpSoKhach.addEventListener('input', calculateTotal);

    function calculateTotal() {
        let quantity = parseInt(inpSoKhach.value) || 0;

        // Ki·ªÉm tra kh√¥ng cho nh·∫≠p qu√° s·ªë gh·∫ø
        if (quantity > maxSeats && maxSeats > 0) {
            alert(`Ch·ªâ c√≤n ${maxSeats} ch·ªó th√¥i ·∫°!`);
            inpSoKhach.value = maxSeats;
            quantity = maxSeats;
        }

        // T√≠nh ti·ªÅn: S·ªë kh√°ch * Gi√° v√© hi·ªán t·∫°i
        const total = quantity * currentPrice;
        txtTotal.innerText = total.toLocaleString('vi-VN') + ' ‚Ç´';
    }

    // H√†m d·ªçn d·∫πp form khi ch∆∞a ch·ªçn g√¨
    function resetForm() {
        currentPrice = 0;
        maxSeats = 0;
        txtSeatInfo.innerText = "(Vui l√≤ng ch·ªçn chuy·∫øn)";
        txtSeatInfo.style.color = "yellow";
        txtTotal.innerText = "0 ‚Ç´";
    }
</script>
</body>
</html>